A proof of concept for how to use caffeine as a versioned cache
================

Has following properties:
- Reuses cache entries from previous version if current version has no entry, therefore saves memory
- If cache is empty and a version beyond the first is accessed, all keys are set up for the versions in between
- Runs everything asynchronously and in bulk (10 caffeine threads can feed 100s of clients)
- Uses standard eviction policies from caffeine
- Only queries current version from DB and then previous version from cache in default case

Example output:

    Loading from db [Key(key=Thread 1: 1, version=10), Key(key=Thread 1: 2, version=10), Key(key=Thread 1: 3, version=10), Key(key=Thread 1: 4, version=10), Key(key=Thread 1: 5, version=10), Key(key=Thread 1: 6, version=10), Key(key=Thread 1: 7, version=10), Key(key=Thread 1: 8, version=10), Key(key=Thread 1: 9, version=10)]
    Returning {Key(key=Thread 1: 8, version=10)=Value(key='Some key', creationVersion=10)}
    Loading from db [Key(key=Thread 1: 1, version=9), Key(key=Thread 1: 2, version=9), Key(key=Thread 1: 3, version=9), Key(key=Thread 1: 4, version=9), Key(key=Thread 1: 5, version=9), Key(key=Thread 1: 6, version=9), Key(key=Thread 1: 7, version=9), Key(key=Thread 1: 9, version=9)]
    Returning {Key(key=Thread 1: 5, version=9)=Value(key='Some key', creationVersion=9)}
    Loading from db [Key(key=Thread 1: 1, version=8), Key(key=Thread 1: 2, version=8), Key(key=Thread 1: 3, version=8), Key(key=Thread 1: 4, version=8), Key(key=Thread 1: 6, version=8), Key(key=Thread 1: 7, version=8), Key(key=Thread 1: 9, version=8)]
    Returning {Key(key=Thread 1: 9, version=8)=Value(key='Some key', creationVersion=8)}
    Loading from db [Key(key=Thread 1: 1, version=7), Key(key=Thread 1: 2, version=7), Key(key=Thread 1: 3, version=7), Key(key=Thread 1: 4, version=7), Key(key=Thread 1: 6, version=7), Key(key=Thread 1: 7, version=7)]
    Returning {Key(key=Thread 1: 1, version=7)=Value(key='Some key', creationVersion=7)}
    Loading from db [Key(key=Thread 1: 2, version=6), Key(key=Thread 1: 3, version=6), Key(key=Thread 1: 4, version=6), Key(key=Thread 1: 6, version=6), Key(key=Thread 1: 7, version=6)]
    Returning {Key(key=Thread 1: 6, version=6)=Value(key='Some key', creationVersion=6)}
    Loading from db [Key(key=Thread 1: 2, version=5), Key(key=Thread 1: 3, version=5), Key(key=Thread 1: 4, version=5), Key(key=Thread 1: 7, version=5)]
    Returning {Key(key=Thread 1: 4, version=5)=Value(key='Some key', creationVersion=5)}
    Loading from db [Key(key=Thread 1: 2, version=4), Key(key=Thread 1: 3, version=4), Key(key=Thread 1: 7, version=4)]
    Returning {}
    Loading from db [Key(key=Thread 1: 2, version=3), Key(key=Thread 1: 3, version=3), Key(key=Thread 1: 7, version=3)]
    Returning {Key(key=Thread 1: 2, version=3)=Value(key='Some key', creationVersion=3)}
    Loading from db [Key(key=Thread 1: 3, version=2), Key(key=Thread 1: 7, version=2)]
    Returning {}
    Loading from db [Key(key=Thread 1: 3, version=1), Key(key=Thread 1: 7, version=1)]
    Returning {Key(key=Thread 1: 7, version=1)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=1)=Value(key='Some key', creationVersion=1)}
    Looking up 10: {Key(key=Thread 1: 1, version=10)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 2, version=10)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 3, version=10)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 4, version=10)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 5, version=10)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 6, version=10)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 7, version=10)=Value(key='', creationVersion=-1), Key(key=Thread 1: 8, version=10)=Value(key='Some key', creationVersion=10), Key(key=Thread 1: 9, version=10)=Value(key='Some key', creationVersion=8)}
    Took: 145 ms
    Loaded from db 10 times
    Active threads: 15
    Active threads: 15
    Amount of keys in cache: 49
    Actual stored values in memory: 9
    Minimum version: Key(key=Thread 1: 7, version=1)=Value(key='', creationVersion=-1)
    Entries to be evicted: {Key(key=Thread 1: 7, version=1)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=1)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 3, version=2)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 7, version=2)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=3)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=3)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=3)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=4)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=4)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=4)=Value(key='', creationVersion=-1), Key(key=Thread 1: 4, version=5)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=5)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=5)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=5)=Value(key='', creationVersion=-1), Key(key=Thread 1: 7, version=6)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=6)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=6)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=6)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=6)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=7)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=7)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=7)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=7)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=7)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=7)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=8)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 7, version=8)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=8)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=8)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=8)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=8)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=8)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=9)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 7, version=9)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=9)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 5, version=9)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 4, version=9)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=9)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=9)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=9)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=10)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 8, version=10)=Value(key='Some key', creationVersion=10), Key(key=Thread 1: 7, version=10)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=10)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 5, version=10)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 4, version=10)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=10)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=10)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=10)=Value(key='Some key', creationVersion=7)}
    =======================================================================

    Loading from db [Key(key=Thread 1: 1, version=11), Key(key=Thread 1: 2, version=11), Key(key=Thread 1: 3, version=11), Key(key=Thread 1: 4, version=11), Key(key=Thread 1: 5, version=11), Key(key=Thread 1: 6, version=11), Key(key=Thread 1: 7, version=11), Key(key=Thread 1: 8, version=11), Key(key=Thread 1: 9, version=11)]
    Returning {}
    Looking up 11: {Key(key=Thread 1: 1, version=11)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 2, version=11)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 3, version=11)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 4, version=11)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 5, version=11)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 6, version=11)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 7, version=11)=Value(key='', creationVersion=-1), Key(key=Thread 1: 8, version=11)=Value(key='Some key', creationVersion=10), Key(key=Thread 1: 9, version=11)=Value(key='Some key', creationVersion=8)}
    Took: 11 ms
    Loaded from db 11 times
    Active threads: 15
    Active threads: 15
    Amount of keys in cache: 58
    Actual stored values in memory: 9
    Minimum version: Key(key=Thread 1: 7, version=1)=Value(key='', creationVersion=-1)
    Entries to be evicted: {Key(key=Thread 1: 7, version=1)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=1)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 3, version=2)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 7, version=2)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=3)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=3)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=3)=Value(key='', creationVersion=-1), Key(key=Thread 1: 3, version=4)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=4)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=4)=Value(key='', creationVersion=-1), Key(key=Thread 1: 4, version=5)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=5)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=5)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=5)=Value(key='', creationVersion=-1), Key(key=Thread 1: 7, version=6)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=6)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=6)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=6)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=6)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 7, version=7)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=7)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=7)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=7)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=7)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=7)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=8)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 7, version=8)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=8)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 4, version=8)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=8)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=8)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=8)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=9)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 7, version=9)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=9)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 5, version=9)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 4, version=9)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=9)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=9)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=9)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=10)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 8, version=10)=Value(key='Some key', creationVersion=10), Key(key=Thread 1: 7, version=10)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=10)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 5, version=10)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 4, version=10)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=10)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=10)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=10)=Value(key='Some key', creationVersion=7), Key(key=Thread 1: 9, version=11)=Value(key='Some key', creationVersion=8), Key(key=Thread 1: 8, version=11)=Value(key='Some key', creationVersion=10), Key(key=Thread 1: 7, version=11)=Value(key='', creationVersion=-1), Key(key=Thread 1: 6, version=11)=Value(key='Some key', creationVersion=6), Key(key=Thread 1: 5, version=11)=Value(key='Some key', creationVersion=9), Key(key=Thread 1: 4, version=11)=Value(key='Some key', creationVersion=5), Key(key=Thread 1: 3, version=11)=Value(key='Some key', creationVersion=1), Key(key=Thread 1: 2, version=11)=Value(key='Some key', creationVersion=3), Key(key=Thread 1: 1, version=11)=Value(key='Some key', creationVersion=7)}
    =======================================================================
